#!/bin/bash

# Resolve to project root
PROJECT_ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"

# Set virtualenv path
VENV_DIR="$PROJECT_ROOT/venv"
PYTHON="$VENV_DIR/bin/python"

# Create virtualenv if it doesn't exist
if [ ! -d "$VENV_DIR" ]; then
  echo "ðŸ§ª Creating virtualenv..."
  python3 -m venv "$VENV_DIR"
fi

# Activate virtualenv
source "$VENV_DIR/bin/activate"

# Install dependencies if not present
echo "ðŸ“¦ Installing dependencies..."
pip install -r "$PROJECT_ROOT/requirements.txt"

# Optional: Install dev requirements
if [ -f "$PROJECT_ROOT/requirements-dev.txt" ]; then
  pip install -r "$PROJECT_ROOT/requirements-dev.txt"
fi

# Run the app
echo "ðŸš€ Launching Hyperdirmic in dev mode..."
$PYTHON "$PROJECT_ROOT/src/organizer.py"
